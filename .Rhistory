setwd("C:/Users/harsh/Desktop/R Shiny")
setwd("C:/Users/harsh/Desktop/R Shiny/app")
library(shiny); runApp('appdashboard.R')
# read data
data <- read.csv('data/2018_Data.csv')
print(data)
View(data)
# Read required columns file (column)
column <- read.csv('data/2018_MetaData.csv')
# select the required columns from the total data
main_df <- select(data, column$Column_Name)
print(main_df)
main_df <- main_df[-c(1),]
rownames(main_df) <- 1:nrow(main_df)
print(main_df)
main_df <- main_df %>%
rename_at(vars(GEO_ID:DP05_0089E), ~ column$Label_Shortcut) %>%
separate_wider_delim(NAME, ",", names = c('COUNTY', 'STATE'))
library(tidyverse)
main_df <- main_df %>%
rename_at(vars(GEO_ID:DP05_0089E), ~ column$Label_Shortcut) %>%
separate_wider_delim(NAME, ",", names = c('COUNTY', 'STATE'))
main_df$COUNTY <- gsub(" County", "", as.character(main_df$COUNTY))
print(main_df)
# Check Null values
sum(is.null(main_df))
sapply(main_df, class)
# Function to convert from character to integer without error handling
convert_to_integer <- function(x) {
as.integer(ifelse(grepl("^-?\\d+$", x), x, NA))
}
# Function to convert from character to numeric without error handling
convert_to_numeric <- function(x) {
as.numeric(ifelse(grepl("^-?\\d+\\.?\\d*$", x), x, NA))
}
# Columns to convert to float
float_columns <- c("SA_TP_SEX_RATIO",
"SA_TP_MEDIAN_AGE",
"SA_TP_18_ABOVE_SEX_RATIO",
"SA_TP_65_ABOVE_SEX_RATIO")
character_columns <- c("GEO_ID", "COUNTY", "STATE")
# Columns to convert to integer
integer_columns <- setdiff(names(main_df), c(float_columns, character_columns))
main_df <- main_df %>%
mutate(across(all_of(float_columns), convert_to_numeric),
across(all_of(integer_columns), convert_to_integer))
print(main_df)
state <- unique(main_df$STATE)
df_state <- data.frame(state)
print(df_state)
df_fips <- read.csv("data/COUNTY-FIPS.csv")
df_fips
# add leading zeros
df_fips <- data.frame(distinct(df_fips))
df_fips$FIPS_CODE <- sprintf("%05d", df_fips$FIPS_CODE)
print(df_fips)
df_state_abbr <- read.csv("data/State-Abbr.csv")
df_state_abbr
df_fips_state <- merge(df_fips, df_state_abbr, by = "STATE_ABBR")
df_fips_state
df_fips_state <- merge(df_fips, df_state_abbr, by = c("STATE","STATE_ABBR"))
df_fips_state
df_state_abbr <- read.csv("data/State-Abbr.csv")
df_state_abbr
df_fips_state <- df_fips_state[order(df_fips_state$STATE, df_fips_state$COUNTY), ]
rownames(df_fips_state) <- 1:nrow(df_fips_state)
df_fips_state$COUNTY <- gsub(" County", "", as.character(df_fips_state$COUNTY))
df_fips_state
# Trim Preceding or succeeding spaces
main_df$STATE <- trimws(main_df$STATE)
df <- merge(main_df, df_fips_state, by = c("COUNTY", "STATE"))
df
print(sum(is.na(df)))
# Get null values in dataframe
df[!complete.cases(df), ]
df$SA_TP_65_ABOVE_SEX_RATIO[is.na(df$SA_TP_65_ABOVE_SEX_RATIO)] <- 0
print(sum(is.na(df)))
df <- df[order(df$STATE, df$COUNTY), ]
rownames(df) <- 1:nrow(df)
df
